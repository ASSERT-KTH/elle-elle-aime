{
    "bug_id": 104,
    "classification": {
        "singleLine": false
    },
    "commit": "e76d23b0",
    "failing_tests": [
        "org.apache.camel.builder.PredicateBuilderTest"
    ],
    "files": 1,
    "jira_id": "3433",
    "linesAdd": 12,
    "linesRem": 3,
    "nb_error": 1,
    "nb_failure": 0,
    "nb_skipped": 0,
    "nb_test": 3008,
    "patch": "diff --git a/camel-core/src/main/java/org/apache/camel/builder/ExpressionBuilder.java b/camel-core/src/main/java/org/apache/camel/builder/ExpressionBuilder.java\nindex 5f73fe310b..db029ec912 100644\n--- a/camel-core/src/main/java/org/apache/camel/builder/ExpressionBuilder.java\n+++ b/camel-core/src/main/java/org/apache/camel/builder/ExpressionBuilder.java\n@@ -935,12 +935,16 @@ public String toString() {\n     public static Expression convertToExpression(final Expression expression, final Class type) {\n         return new ExpressionAdapter() {\n             public Object evaluate(Exchange exchange) {\n+                if (type != null) {\n                     return expression.evaluate(exchange, type);\n+                } else {\n+                    return expression;\n+                }\n             }\n \n             @Override\n             public String toString() {\n-                return \"\" + expression + \".convertTo(\" + type.getCanonicalName() + \".class)\";\n+                return \"\" + expression;\n             }\n         };\n     }\n@@ -952,12 +956,17 @@ public String toString() {\n     public static Expression convertToExpression(final Expression expression, final Expression type) {\n         return new ExpressionAdapter() {\n             public Object evaluate(Exchange exchange) {\n-                return expression.evaluate(exchange, type.evaluate(exchange, Object.class).getClass());\n+                Object result = type.evaluate(exchange, Object.class);\n+                if (result != null) {\n+                    return expression.evaluate(exchange, result.getClass());\n+                } else {\n+                    return expression;\n+                }\n             }\n \n             @Override\n             public String toString() {\n-                return \"\" + expression + \".convertToEvaluatedType(\" + type + \")\";\n+                return \"\" + expression;\n             }\n         };\n     }\n",
    "project": "camel",
    "buggy_compile_success": false,
    "buggy_test_success": false,
    "fixed_compile_success": false,
    "fixed_test_success": false
}