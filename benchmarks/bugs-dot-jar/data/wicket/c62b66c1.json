{
  "files": 2, 
  "nb_test": 1114, 
  "nb_error": 0, 
  "classification": {
    "singleLine": false
  }, 
  "failing_tests": [
    "org.apache.wicket.PlaceholderTagIdTest"
  ], 
  "patch": "diff --git a/wicket-core/src/main/java/org/apache/wicket/Component.java b/wicket-core/src/main/java/org/apache/wicket/Component.java\nindex 238b278932..6644c24a63 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/Component.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/Component.java\n@@ -23,6 +23,7 @@\n import java.util.Locale;\n import java.util.Stack;\n \n+import org.apache.wicket.ajax.IAjaxRegionMarkupIdProvider;\n import org.apache.wicket.authorization.Action;\n import org.apache.wicket.authorization.AuthorizationException;\n import org.apache.wicket.authorization.IAuthorizationStrategy;\n@@ -2463,7 +2464,7 @@ protected void renderPlaceholderTag(final ComponentTag tag, final Response respo\n \t\t}\n \t\tresponse.write(tag.getName());\n \t\tresponse.write(\" id=\\\"\");\n-\t\tresponse.write(getMarkupId());\n+\t\tresponse.write(getAjaxRegionMarkupId());\n \t\tresponse.write(\"\\\" style=\\\"display:none\\\"></\");\n \t\tif (ns != null)\n \t\t{\n@@ -2473,6 +2474,39 @@ protected void renderPlaceholderTag(final ComponentTag tag, final Response respo\n \t\tresponse.write(\">\");\n \t}\n \n+\n+\t/**\n+\t * Returns the id of the markup region that will be updated via ajax. This can be different to\n+\t * the markup id of the component if a {@link IAjaxRegionMarkupIdProvider} behavior has been\n+\t * added.\n+\t * \n+\t * @return the markup id of the region to be updated via ajax.\n+\t */\n+\tpublic final String getAjaxRegionMarkupId()\n+\t{\n+\t\tString markupId = null;\n+\t\tfor (Behavior behavior : getBehaviors())\n+\t\t{\n+\t\t\tif (behavior instanceof IAjaxRegionMarkupIdProvider)\n+\t\t\t{\n+\t\t\t\tmarkupId = ((IAjaxRegionMarkupIdProvider)behavior).getAjaxRegionMarkupId(this);\n+\t\t\t}\n+\t\t}\n+\t\tif (markupId == null)\n+\t\t{\n+\t\t\tif (this instanceof IAjaxRegionMarkupIdProvider)\n+\t\t\t{\n+\t\t\t\tmarkupId = ((IAjaxRegionMarkupIdProvider)this).getAjaxRegionMarkupId(this);\n+\t\t\t}\n+\t\t}\n+\t\tif (markupId == null)\n+\t\t{\n+\t\t\tmarkupId = getMarkupId();\n+\t\t}\n+\t\treturn markupId;\n+\t}\n+\n+\n \t/**\n \t * THIS METHOD IS NOT PART OF THE WICKET PUBLIC API. DO NOT USE IT.\n \t * <p>\ndiff --git a/wicket-core/src/main/java/org/apache/wicket/ajax/AjaxRequestTarget.java b/wicket-core/src/main/java/org/apache/wicket/ajax/AjaxRequestTarget.java\nindex f6ff1adadb..7b2467e578 100644\n--- a/wicket-core/src/main/java/org/apache/wicket/ajax/AjaxRequestTarget.java\n+++ b/wicket-core/src/main/java/org/apache/wicket/ajax/AjaxRequestTarget.java\n@@ -31,7 +31,6 @@\n import org.apache.wicket.Component;\n import org.apache.wicket.MarkupContainer;\n import org.apache.wicket.Page;\n-import org.apache.wicket.behavior.Behavior;\n import org.apache.wicket.event.Broadcast;\n import org.apache.wicket.markup.html.IHeaderResponse;\n import org.apache.wicket.markup.html.internal.HeaderResponse;\n@@ -753,7 +752,7 @@ private void respondComponents(Response response)\n \n \t\t\tif (!containsAncestorFor(component))\n \t\t\t{\n-\t\t\t\trespondComponent(response, getAjaxRegionMarkupId(component), component);\n+\t\t\t\trespondComponent(response, component.getAjaxRegionMarkupId(), component);\n \t\t\t}\n \t\t}\n \n@@ -803,30 +802,6 @@ private void writeHeaderContribution(Response response)\n \t\t}\n \t}\n \n-\tprivate String getAjaxRegionMarkupId(Component component)\n-\t{\n-\t\tString markupId = null;\n-\t\tfor (Behavior behavior : component.getBehaviors())\n-\t\t{\n-\t\t\tif (behavior instanceof IAjaxRegionMarkupIdProvider)\n-\t\t\t{\n-\t\t\t\tmarkupId = ((IAjaxRegionMarkupIdProvider)behavior).getAjaxRegionMarkupId(component);\n-\t\t\t}\n-\t\t}\n-\t\tif (markupId == null)\n-\t\t{\n-\t\t\tif (component instanceof IAjaxRegionMarkupIdProvider)\n-\t\t\t{\n-\t\t\t\tmarkupId = ((IAjaxRegionMarkupIdProvider)component).getAjaxRegionMarkupId(component);\n-\t\t\t}\n-\t\t}\n-\t\tif (markupId == null)\n-\t\t{\n-\t\t\tmarkupId = component.getMarkupId();\n-\t\t}\n-\t\treturn markupId;\n-\t}\n-\n \t/**\n \t * Checks if the target contains an ancestor for the given component\n \t * \n", 
  "project": "wicket", 
  "linesAdd": 36, 
  "jira_id": "3563", 
  "nb_skipped": 0, 
  "commit": "c62b66c1", 
  "nb_failure": 1, 
  "linesRem": 27
}